(function(t,e){"use strict";var n,i=e.event;i.special.smartresize={setup:function(){e(this).bind("resize",i.special.smartresize.handler)},teardown:function(){e(this).unbind("resize",i.special.smartresize.handler)},handler:function(t,i){var r=this,s=arguments;t.type="smartresize",n&&clearTimeout(n),n=setTimeout(function(){e.event.handle.apply(r,s)},i==="execAsap"?0:100)}},e.fn.smartresize=function(t){return t?this.bind("smartresize",t):this.trigger("smartresize",["execAsap"])},e.Mason=function(t,n){this.element=e(n),this._create(t),this._init()},e.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:"relative"}},e.Mason.prototype={_filterFindBricks:function(t){var e=this.options.itemSelector;return e?t.filter(e).add(t.find(e)):t},_getBricks:function(t){var e=this._filterFindBricks(t).css({position:"absolute"}).addClass("masonry-brick");return e},_create:function(n){this.options=e.extend(!0,{},e.Mason.settings,n),this.styleQueue=[];var i=this.element[0].style;this.originalStyle={height:i.height||""};var r=this.options.containerStyle;for(var s in r)this.originalStyle[s]=i[s]||"";this.element.css(r),this.horizontalDirection=this.options.isRTL?"right":"left",this.offset={x:parseInt(this.element.css("padding-"+this.horizontalDirection),10),y:parseInt(this.element.css("padding-top"),10)},this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth=="function";var a=this;setTimeout(function(){a.element.addClass("masonry")},0),this.options.isResizable&&e(t).bind("smartresize.masonry",function(){a.resize()}),this.reloadItems()},_init:function(t){this._getColumns(),this._reLayout(t)},option:function(t){e.isPlainObject(t)&&(this.options=e.extend(!0,this.options,t))},layout:function(t,e){for(var n=0,i=t.length;i>n;n++)this._placeBrick(t[n]);var r={};if(r.height=Math.max.apply(Math,this.colYs),this.options.isFitWidth){var s=0;n=this.cols;while(--n){if(this.colYs[n]!==0)break;s++}r.width=(this.cols-s)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:r});var a,o=this.isLaidOut?this.options.isAnimated?"animate":"css":"css",u=this.options.animationOptions;for(n=0,i=this.styleQueue.length;i>n;n++)a=this.styleQueue[n],a.$el[o](a.style,u);this.styleQueue=[],e&&e.call(t),this.isLaidOut=!0},_getColumns:function(){var t=this.options.isFitWidth?this.element.parent():this.element,e=t.width();this.columnWidth=this.isFluid?this.options.columnWidth(e):this.options.columnWidth||this.$bricks.outerWidth(!0)||e,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((e+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(t){var n,i,r,s,a,o=e(t);if(n=Math.ceil(o.outerWidth(!0)/this.columnWidth),n=Math.min(n,this.cols),n===1)r=this.colYs;else for(i=this.cols+1-n,r=[],a=0;i>a;a++)s=this.colYs.slice(a,a+n),r[a]=Math.max.apply(Math,s);for(var u=Math.min.apply(Math,r),l=0,c=0,h=r.length;h>c;c++)if(r[c]===u){l=c;break}var p={top:u+this.offset.y};p[this.horizontalDirection]=this.columnWidth*l+this.offset.x,this.styleQueue.push({$el:o,style:p});var f=u+o.outerHeight(!0),d=this.cols+1-h;for(c=0;d>c;c++)this.colYs[l+c]=f},resize:function(){var t=this.cols;this._getColumns(),(this.isFluid||this.cols!==t)&&this._reLayout()},_reLayout:function(t){var e=this.cols;this.colYs=[];while(e--)this.colYs.push(0);this.layout(this.$bricks,t)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(t){this.reloadItems(),this._init(t)},appended:function(t,e,n){if(e){this._filterFindBricks(t).css({top:this.element.height()});var i=this;setTimeout(function(){i._appended(t,n)},1)}else this._appended(t,n)},_appended:function(t,e){var n=this._getBricks(t);this.$bricks=this.$bricks.add(n),this.layout(n,e)},remove:function(t){this.$bricks=this.$bricks.not(t),t.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="",this.style.top="",this.style.left=""});var n=this.element[0].style;for(var i in this.originalStyle)n[i]=this.originalStyle[i];this.element.unbind(".masonry").removeClass("masonry").removeData("masonry"),e(t).unbind(".masonry")}},e.fn.imagesLoaded=function(t){function n(){t.call(r,s)}function i(t){var r=t.target;r.src!==o&&e.inArray(r,u)===-1&&(u.push(r),0>=--a&&(setTimeout(n),s.unbind(".imagesLoaded",i)))}var r=this,s=r.find("img").add(r.filter("img")),a=s.length,o="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",u=[];return a||n(),s.bind("load.imagesLoaded error.imagesLoaded",i).each(function(){var t=this.src;this.src=o,this.src=t}),r};var r=function(e){t.console&&t.console.error(e)};e.fn.masonry=function(t){if(typeof t=="string"){var n=Array.prototype.slice.call(arguments,1);this.each(function(){var i=e.data(this,"masonry");return i?e.isFunction(i[t])&&t.charAt(0)!=="_"?(i[t].apply(i,n),void 0):(r("no such method '"+t+"' for masonry instance"),void 0):(r("cannot call methods on masonry prior to initialization; attempted to call method '"+t+"'"),void 0)})}else this.each(function(){var n=e.data(this,"masonry");n?(n.option(t||{}),n._init()):e.data(this,"masonry",new e.Mason(t,this))});return this}})(window,jQuery),function(){var t=this,e=t._,n={},i=Array.prototype,r=Object.prototype,s=Function.prototype,a=i.push,o=i.slice,u=i.concat,l=(i.unshift,r.toString),c=r.hasOwnProperty,h=i.forEach,p=i.map,f=i.reduce,d=i.reduceRight,g=i.filter,m=i.every,v=i.some,y=i.indexOf,b=i.lastIndexOf,_=Array.isArray,w=Object.keys,x=s.bind,k=function(t){return t instanceof k?t:this instanceof k?(this._wrapped=t,void 0):new k(t)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=k),exports._=k):t._=k,k.VERSION="1.4.2";var E=k.each=k.forEach=function(t,e,i){if(t!=null)if(h&&t.forEach===h)t.forEach(e,i);else if(t.length===+t.length){for(var r=0,s=t.length;s>r;r++)if(e.call(i,t[r],r,t)===n)return}else for(var a in t)if(k.has(t,a)&&e.call(i,t[a],a,t)===n)return};k.map=k.collect=function(t,e,n){var i=[];return t==null?i:p&&t.map===p?t.map(e,n):(E(t,function(t,r,s){i[i.length]=e.call(n,t,r,s)}),i)},k.reduce=k.foldl=k.inject=function(t,e,n,i){var r=arguments.length>2;if(t==null&&(t=[]),f&&t.reduce===f)return i&&(e=k.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(E(t,function(t,s,a){r?n=e.call(i,n,t,s,a):(n=t,r=!0)}),!r)throw new TypeError("Reduce of empty array with no initial value");return n},k.reduceRight=k.foldr=function(t,e,n,i){var r=arguments.length>2;if(t==null&&(t=[]),d&&t.reduceRight===d)return i&&(e=k.bind(e,i)),arguments.length>2?t.reduceRight(e,n):t.reduceRight(e);var s=t.length;if(s!==+s){var a=k.keys(t);s=a.length}if(E(t,function(o,u,l){u=a?a[--s]:--s,r?n=e.call(i,n,t[u],u,l):(n=t[u],r=!0)}),!r)throw new TypeError("Reduce of empty array with no initial value");return n},k.find=k.detect=function(t,e,n){var i;return A(t,function(t,r,s){return e.call(n,t,r,s)?(i=t,!0):void 0}),i},k.filter=k.select=function(t,e,n){var i=[];return t==null?i:g&&t.filter===g?t.filter(e,n):(E(t,function(t,r,s){e.call(n,t,r,s)&&(i[i.length]=t)}),i)},k.reject=function(t,e,n){var i=[];return t==null?i:(E(t,function(t,r,s){e.call(n,t,r,s)||(i[i.length]=t)}),i)},k.every=k.all=function(t,e,i){e||(e=k.identity);var r=!0;return t==null?r:m&&t.every===m?t.every(e,i):(E(t,function(t,s,a){return(r=r&&e.call(i,t,s,a))?void 0:n}),!!r)};var A=k.some=k.any=function(t,e,i){e||(e=k.identity);var r=!1;return t==null?r:v&&t.some===v?t.some(e,i):(E(t,function(t,s,a){return r||(r=e.call(i,t,s,a))?n:void 0}),!!r)};k.contains=k.include=function(t,e){var n=!1;return t==null?n:y&&t.indexOf===y?t.indexOf(e)!=-1:n=A(t,function(t){return t===e})},k.invoke=function(t,e){var n=o.call(arguments,2);return k.map(t,function(t){return(k.isFunction(e)?e:t[e]).apply(t,n)})},k.pluck=function(t,e){return k.map(t,function(t){return t[e]})},k.where=function(t,e){return k.isEmpty(e)?[]:k.filter(t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},k.max=function(t,e,n){if(!e&&k.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.max.apply(Math,t);if(!e&&k.isEmpty(t))return-1/0;var i={computed:-1/0};return E(t,function(t,r,s){var a=e?e.call(n,t,r,s):t;a>=i.computed&&(i={value:t,computed:a})}),i.value},k.min=function(t,e,n){if(!e&&k.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.min.apply(Math,t);if(!e&&k.isEmpty(t))return 1/0;var i={computed:1/0};return E(t,function(t,r,s){var a=e?e.call(n,t,r,s):t;i.computed>a&&(i={value:t,computed:a})}),i.value},k.shuffle=function(t){var e,n=0,i=[];return E(t,function(t){e=k.random(n++),i[n-1]=i[e],i[e]=t}),i};var S=function(t){return k.isFunction(t)?t:function(e){return e[t]}};k.sortBy=function(t,e,n){var i=S(e);return k.pluck(k.map(t,function(t,e,r){return{value:t,index:e,criteria:i.call(n,t,e,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||n===void 0)return 1;if(i>n||i===void 0)return-1}return e.index>t.index?-1:1}),"value")};var H=function(t,e,n,i){var r={},s=S(e);return E(t,function(e,a){var o=s.call(n,e,a,t);i(r,o,e)}),r};k.groupBy=function(t,e,n){return H(t,e,n,function(t,e,n){(k.has(t,e)?t[e]:t[e]=[]).push(n)})},k.countBy=function(t,e,n){return H(t,e,n,function(t,e){k.has(t,e)||(t[e]=0),t[e]++})},k.sortedIndex=function(t,e,n,i){n=n==null?k.identity:S(n);var r=n.call(i,e),s=0,a=t.length;while(a>s){var o=s+a>>>1;r>n.call(i,t[o])?s=o+1:a=o}return s},k.toArray=function(t){return t?t.length===+t.length?o.call(t):k.values(t):[]},k.size=function(t){return t.length===+t.length?t.length:k.keys(t).length},k.first=k.head=k.take=function(t,e,n){return e==null||n?t[0]:o.call(t,0,e)},k.initial=function(t,e,n){return o.call(t,0,t.length-(e==null||n?1:e))},k.last=function(t,e,n){return e==null||n?t[t.length-1]:o.call(t,Math.max(t.length-e,0))},k.rest=k.tail=k.drop=function(t,e,n){return o.call(t,e==null||n?1:e)},k.compact=function(t){return k.filter(t,function(t){return!!t})};var O=function(t,e,n){return E(t,function(t){k.isArray(t)?e?a.apply(n,t):O(t,e,n):n.push(t)}),n};k.flatten=function(t,e){return O(t,e,[])},k.without=function(t){return k.difference(t,o.call(arguments,1))},k.uniq=k.unique=function(t,e,n,i){var r=n?k.map(t,n,i):t,s=[],a=[];return E(r,function(n,i){(e?i&&a[a.length-1]===n:k.contains(a,n))||(a.push(n),s.push(t[i]))}),s},k.union=function(){return k.uniq(u.apply(i,arguments))},k.intersection=function(t){var e=o.call(arguments,1);return k.filter(k.uniq(t),function(t){return k.every(e,function(e){return k.indexOf(e,t)>=0})})},k.difference=function(t){var e=u.apply(i,o.call(arguments,1));return k.filter(t,function(t){return!k.contains(e,t)})},k.zip=function(){for(var t=o.call(arguments),e=k.max(k.pluck(t,"length")),n=Array(e),i=0;e>i;i++)n[i]=k.pluck(t,""+i);return n},k.object=function(t,e){for(var n={},i=0,r=t.length;r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},k.indexOf=function(t,e,n){if(t==null)return-1;var i=0,r=t.length;if(n){if(typeof n!="number")return i=k.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;r>i;i++)if(t[i]===e)return i;return-1},k.lastIndexOf=function(t,e,n){if(t==null)return-1;var i=n!=null;if(b&&t.lastIndexOf===b)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);var r=i?n:t.length;while(r--)if(t[r]===e)return r;return-1},k.range=function(t,e,n){1>=arguments.length&&(e=t||0,t=0),n=arguments[2]||1;var i=Math.max(Math.ceil((e-t)/n),0),r=0,s=Array(i);while(i>r)s[r++]=t,t+=n;return s};var j=function(){};k.bind=function(t,e){var n,i;if(t.bind===x&&x)return x.apply(t,o.call(arguments,1));if(!k.isFunction(t))throw new TypeError;return i=o.call(arguments,2),n=function(){if(this instanceof n){j.prototype=t.prototype;var r=new j,s=t.apply(r,i.concat(o.call(arguments)));return Object(s)===s?s:r}return t.apply(e,i.concat(o.call(arguments)))}},k.bindAll=function(t){var e=o.call(arguments,1);return e.length==0&&(e=k.functions(t)),E(e,function(e){t[e]=k.bind(t[e],t)}),t},k.memoize=function(t,e){var n={};return e||(e=k.identity),function(){var i=e.apply(this,arguments);return k.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},k.delay=function(t,e){var n=o.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},k.defer=function(t){return k.delay.apply(k,[t,1].concat(o.call(arguments,1)))},k.throttle=function(t,e){var n,i,r,s,a,o,u=k.debounce(function(){a=s=!1},e);return function(){n=this,i=arguments;var l=function(){r=null,a&&(o=t.apply(n,i)),u()};return r||(r=setTimeout(l,e)),s?a=!0:(s=!0,o=t.apply(n,i)),u(),o}},k.debounce=function(t,e,n){var i,r;return function(){var s=this,a=arguments,o=function(){i=null,n||(r=t.apply(s,a))},u=n&&!i;return clearTimeout(i),i=setTimeout(o,e),u&&(r=t.apply(s,a)),r}},k.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},k.wrap=function(t,e){return function(){var n=[t];return a.apply(n,arguments),e.apply(this,n)}},k.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},k.after=function(t,e){return t>0?function(){return 1>--t?e.apply(this,arguments):void 0}:e()},k.keys=w||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)k.has(t,n)&&(e[e.length]=n);return e},k.values=function(t){var e=[];for(var n in t)k.has(t,n)&&e.push(t[n]);return e},k.pairs=function(t){var e=[];for(var n in t)k.has(t,n)&&e.push([n,t[n]]);return e},k.invert=function(t){var e={};for(var n in t)k.has(t,n)&&(e[t[n]]=n);return e},k.functions=k.methods=function(t){var e=[];for(var n in t)k.isFunction(t[n])&&e.push(n);return e.sort()},k.extend=function(t){return E(o.call(arguments,1),function(e){for(var n in e)t[n]=e[n]}),t},k.pick=function(t){var e={},n=u.apply(i,o.call(arguments,1));return E(n,function(n){n in t&&(e[n]=t[n])}),e},k.omit=function(t){var e={},n=u.apply(i,o.call(arguments,1));for(var r in t)k.contains(n,r)||(e[r]=t[r]);return e},k.defaults=function(t){return E(o.call(arguments,1),function(e){for(var n in e)t[n]==null&&(t[n]=e[n])}),t},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t};var M=function(t,e,n,i){if(t===e)return t!==0||1/t==1/e;if(t==null||e==null)return t===e;t instanceof k&&(t=t._wrapped),e instanceof k&&(e=e._wrapped);var r=l.call(t);if(r!=l.call(e))return!1;switch(r){case"[object String]":return t==e+"";case"[object Number]":return t!=+t?e!=+e:t==0?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if(typeof t!="object"||typeof e!="object")return!1;var s=n.length;while(s--)if(n[s]==t)return i[s]==e;n.push(t),i.push(e);var a=0,o=!0;if(r=="[object Array]"){if(a=t.length,o=a==e.length)while(a--)if(!(o=M(t[a],e[a],n,i)))break}else{var u=t.constructor,c=e.constructor;if(u!==c&&!(k.isFunction(u)&&u instanceof u&&k.isFunction(c)&&c instanceof c))return!1;for(var h in t)if(k.has(t,h)&&(a++,!(o=k.has(e,h)&&M(t[h],e[h],n,i))))break;if(o){for(h in e)if(k.has(e,h)&&!a--)break;o=!a}}return n.pop(),i.pop(),o};k.isEqual=function(t,e){return M(t,e,[],[])},k.isEmpty=function(t){if(t==null)return!0;if(k.isArray(t)||k.isString(t))return t.length===0;for(var e in t)if(k.has(t,e))return!1;return!0},k.isElement=function(t){return!!t&&t.nodeType===1},k.isArray=_||function(t){return l.call(t)=="[object Array]"},k.isObject=function(t){return t===Object(t)},E(["Arguments","Function","String","Number","Date","RegExp"],function(t){k["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),k.isArguments(arguments)||(k.isArguments=function(t){return!!t&&!!k.has(t,"callee")}),true&&(k.isFunction=function(t){return typeof t=="function"}),k.isFinite=function(t){return k.isNumber(t)&&isFinite(t)},k.isNaN=function(t){return k.isNumber(t)&&t!=+t},k.isBoolean=function(t){return t===!0||t===!1||l.call(t)=="[object Boolean]"},k.isNull=function(t){return t===null},k.isUndefined=function(t){return t===void 0},k.has=function(t,e){return c.call(t,e)},k.noConflict=function(){return t._=e,this},k.identity=function(t){return t},k.times=function(t,e,n){for(var i=0;t>i;i++)e.call(n,i)},k.random=function(t,e){return e==null&&(e=t,t=0),t+(0|Math.random()*(e-t+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=k.invert(I.escape);var T={escape:RegExp("["+k.keys(I.escape).join("")+"]","g"),unescape:RegExp("("+k.keys(I.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(t){k[t]=function(e){return e==null?"":(""+e).replace(T[t],function(e){return I[t][e]})}}),k.result=function(t,e){if(t==null)return null;var n=t[e];return k.isFunction(n)?n.call(t):n},k.mixin=function(t){E(k.functions(t),function(e){var n=k[e]=t[e];k.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),N.call(this,n.apply(k,t))}})};var R=0;k.uniqueId=function(t){var e=R++;return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(t,e,n){n=k.defaults({},n,k.templateSettings);var i=RegExp([(n.escape||B).source,(n.interpolate||B).source,(n.evaluate||B).source].join("|")+"|$","g"),r=0,s="__p+='";t.replace(i,function(e,n,i,a,o){s+=t.slice(r,o).replace(P,function(t){return"\\"+F[t]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?"'+\n((__t=("+i+"))==null?'':__t)+\n'":a?"';\n"+a+"\n__p+='":"",r=o+e.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var a=Function(n.variable||"obj","_",s)}catch(o){throw o.source=s,o}if(e)return a(e,k);var u=function(t){return a.call(this,t,k)};return u.source="function("+(n.variable||"obj")+"){\n"+s+"}",u},k.chain=function(t){return k(t).chain()};var N=function(t){return this._chain?k(t).chain():t};k.mixin(k),E(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];k.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),(t=="shift"||t=="splice")&&n.length===0&&delete n[0],N.call(this,n)}}),E(["concat","join","slice"],function(t){var e=i[t];k.prototype[t]=function(){return N.call(this,e.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){var t,e=this,n=e.Backbone,i=Array.prototype.slice,r=Array.prototype.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="0.9.2";var s=e._;!s&&"undefined"!=typeof require&&(s=require("underscore"));var a=e.jQuery||e.Zepto||e.ender;t.setDomLibrary=function(t){a=t},t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=/\s+/,u=t.Events={on:function(t,e,n){var i,r,s,a,u;if(!e)return this;for(t=t.split(o),i=this._callbacks||(this._callbacks={});r=t.shift();)s=(u=i[r])?u.tail:{},s.next=a={},s.context=n,s.callback=e,i[r]={tail:a,next:u?u.next:s};return this},off:function(t,e,n){var i,r,a,u,l,c;if(r=this._callbacks){if(!t&&!e&&!n)return delete this._callbacks,this;for(t=t?t.split(o):s.keys(r);i=t.shift();)if(a=r[i],delete r[i],a&&(e||n))for(u=a.tail;(a=a.next)!==u;)(l=a.callback,c=a.context,e&&l!==e||n&&c!==n)&&this.on(i,l,c);return this}},trigger:function(t){var e,n,r,s,a,u;if(!(r=this._callbacks))return this;for(a=r.all,t=t.split(o),u=i.call(arguments,1);e=t.shift();){if(n=r[e])for(s=n.tail;(n=n.next)!==s;)n.callback.apply(n.context||this,u);if(n=a)for(s=n.tail,e=[e].concat(u);(n=n.next)!==s;)n.callback.apply(n.context||this,e)}return this}};u.bind=u.on,u.unbind=u.off;var l=t.Model=function(t,e){var n;t||(t={}),e&&e.parse&&(t=this.parse(t)),(n=E(this,"defaults"))&&(t=s.extend({},n,t)),e&&e.collection&&(this.collection=e.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(t,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(l.prototype,u,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},get:function(t){return this.attributes[t]},escape:function(t){var e;return(e=this._escapedAttributes[t])?e:(e=this.get(t),this._escapedAttributes[t]=s.escape(null==e?"":""+e))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,r;if(s.isObject(t)||null==t?(i=t,n=e):(i={},i[t]=e),n||(n={}),!i)return this;if(i instanceof l&&(i=i.attributes),n.unset)for(r in i)i[r]=void 0;if(!this._validate(i,n))return!1;this.idAttribute in i&&(this.id=i[this.idAttribute]);var e=n.changes={},a=this.attributes,o=this._escapedAttributes,u=this._previousAttributes||{};for(r in i)t=i[r],(!s.isEqual(a[r],t)||n.unset&&s.has(a,r))&&(delete o[r],(n.silent?this._silent:e)[r]=!0),n.unset?delete a[r]:a[r]=t,s.isEqual(u[r],t)&&s.has(a,r)==s.has(u,r)?(delete this.changed[r],delete this._pending[r]):(this.changed[r]=t,n.silent||(this._pending[r]=!0));return n.silent||this.change(n),this},unset:function(t,e){return(e||(e={})).unset=!0,this.set(t,null,e)},clear:function(t){return(t||(t={})).unset=!0,this.set(s.clone(this.attributes),t)},fetch:function(e){var e=e?s.clone(e):{},n=this,i=e.success;return e.success=function(t,r,s){return n.set(n.parse(t,s),e)?(i&&i(n,t),void 0):!1},e.error=t.wrapError(e.error,n,e),(this.sync||t.sync).call(this,"read",this,e)},save:function(e,n,i){var r,a;if(s.isObject(e)||null==e?(r=e,i=n):(r={},r[e]=n),i=i?s.clone(i):{},i.wait){if(!this._validate(r,i))return!1;a=s.clone(this.attributes)}if(e=s.extend({},i,{silent:!0}),r&&!this.set(r,i.wait?e:i))return!1;var o=this,u=i.success;return i.success=function(t,e,n){return e=o.parse(t,n),i.wait&&(delete i.wait,e=s.extend(r||{},e)),o.set(e,i)?(u?u(o,t):o.trigger("sync",o,t,i),void 0):!1},i.error=t.wrapError(i.error,o,i),n=this.isNew()?"create":"update",n=(this.sync||t.sync).call(this,n,this,i),i.wait&&this.set(a,e),n},destroy:function(e){var e=e?s.clone(e):{},n=this,i=e.success,r=function(){n.trigger("destroy",n,n.collection,e)};if(this.isNew())return r(),!1;e.success=function(t){e.wait&&r(),i?i(n,t):n.trigger("sync",n,t,e)},e.error=t.wrapError(e.error,n,e);var a=(this.sync||t.sync).call(this,"delete",this,e);return e.wait||r(),a},url:function(){var t=E(this,"urlRoot")||E(this.collection,"url")||A();return this.isNew()?t:t+("/"==t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(t){t||(t={});var e=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var i=s.extend({},t.changes,this._silent);this._silent={};for(n in i)this.trigger("change:"+n,this,this.get(n),t);if(e)return this;for(;!s.isEmpty(this._pending);){this._pending={},this.trigger("change",this,t);for(n in this.changed)!this._pending[n]&&!this._silent[n]&&delete this.changed[n];this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(t){return arguments.length?s.has(this.changed,t):!s.isEmpty(this.changed)},changedAttributes:function(t){if(!t)return this.hasChanged()?s.clone(this.changed):!1;var e,n,i=!1,r=this._previousAttributes;for(n in t)s.isEqual(r[n],e=t[n])||((i||(i={}))[n]=e);return i},previous:function(t){return arguments.length&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(t,e){if(e.silent||!this.validate)return!0;var t=s.extend({},this.attributes,t),n=this.validate(t,e);return n?(e&&e.error?e.error(this,n,e):this.trigger("error",this,n,e),!1):!0}});var c=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,{silent:!0,parse:e.parse})};s.extend(c.prototype,u,{model:l,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},add:function(t,e){var n,i,a,o,u,l={},c={},h=[];for(e||(e={}),t=s.isArray(t)?t.slice():[t],n=0,i=t.length;i>n;n++){if(!(a=t[n]=this._prepareModel(t[n],e)))throw Error("Can't add an invalid model to a collection");o=a.cid,u=a.id,l[o]||this._byCid[o]||null!=u&&(c[u]||this._byId[u])?h.push(n):l[o]=c[u]=a}for(n=h.length;n--;)t.splice(h[n],1);for(n=0,i=t.length;i>n;n++)(a=t[n]).on("all",this._onModelEvent,this),this._byCid[a.cid]=a,null!=a.id&&(this._byId[a.id]=a);if(this.length+=i,r.apply(this.models,[null!=e.at?e.at:this.models.length,0].concat(t)),this.comparator&&this.sort({silent:!0}),e.silent)return this;for(n=0,i=this.models.length;i>n;n++)l[(a=this.models[n]).cid]&&(e.index=n,a.trigger("add",a,this,e));return this},remove:function(t,e){var n,i,r,a;for(e||(e={}),t=s.isArray(t)?t.slice():[t],n=0,i=t.length;i>n;n++)(a=this.getByCid(t[n])||this.get(t[n]))&&(delete this._byId[a.id],delete this._byCid[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,e.silent||(e.index=r,a.trigger("remove",a,this,e)),this._removeReference(a));return this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,e),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,s.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t]},getByCid:function(t){return t&&this._byCid[t.cid||t]},at:function(t){return this.models[t]},where:function(t){return s.isEmpty(t)?[]:this.filter(function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},sort:function(t){if(t||(t={}),!this.comparator)throw Error("Cannot sort a set without a comparator");var e=s.bind(this.comparator,this);return 1==this.comparator.length?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("reset",this,t),this},pluck:function(t){return s.map(this.models,function(e){return e.get(t)})},reset:function(t,e){t||(t=[]),e||(e={});for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return this._reset(),this.add(t,s.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var n=this,i=e.success;return e.success=function(t,r,s){n[e.add?"add":"reset"](n.parse(t,s),e),i&&i(n,t)},e.error=t.wrapError(e.error,n,e),(this.sync||t.sync).call(this,"read",this,e)},create:function(t,e){var n=this,e=e?s.clone(e):{},t=this._prepareModel(t,e);if(!t)return!1;e.wait||n.add(t,e);var i=e.success;return e.success=function(r,s){e.wait&&n.add(r,e),i?i(r,s):r.trigger("sync",t,s,e)},t.save(null,e),t},parse:function(t){return t},chain:function(){return s(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(t,e){return e||(e={}),t instanceof l?t.collection||(t.collection=this):(e.collection=this,t=new this.model(t,e),t._validate(t.attributes,e)||(t=!1)),t},_removeReference:function(t){this==t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"==t||"remove"==t)&&n!=this||("destroy"==t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],this._byId[e.id]=e),this.trigger.apply(this,arguments))}}),s.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(t){c.prototype[t]=function(){return s[t].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,f=/\*\w+/g,d=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,u,{initialize:function(){},route:function(e,n,i){return t.history||(t.history=new g),s.isRegExp(e)||(e=this._routeToRegExp(e)),i||(i=this[n]),t.history.route(e,s.bind(function(r){r=this._extractParameters(e,r),i&&i.apply(this,r),this.trigger.apply(this,["route:"+n].concat(r)),t.history.trigger("route",this,n,r)},this)),this},navigate:function(e,n){t.history.navigate(e,n)},_bindRoutes:function(){if(this.routes){var t,e=[];for(t in this.routes)e.unshift([t,this.routes[t]]);t=0;for(var n=e.length;n>t;t++)this.route(e[t][0],e[t][1],this[e[t][1]])}},_routeToRegExp:function(t){return t=t.replace(d,"\\$&").replace(p,"([^/]+)").replace(f,"(.*?)"),RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var g=t.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},m=/^[#\/]/,v=/msie [\w.]+/;g.started=!1,s.extend(g.prototype,u,{interval:50,getHash:function(t){return(t=(t?t.location:window.location).href.match(/#(.*)$/))?t[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||e){var t=window.location.pathname,n=window.location.search;n&&(t+=n)}else t=this.getHash();return t.indexOf(this.options.root)||(t=t.substr(this.options.root.length)),t.replace(m,"")},start:function(t){if(g.started)throw Error("Backbone.history has already been started");g.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=this.options.pushState&&window.history&&window.history.pushState;var t=this.getFragment(),e=document.documentMode;return(e=v.exec(navigator.userAgent.toLowerCase())&&(!e||7>=e))&&(this.iframe=a('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?a(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t,t=window.location,e=t.pathname==this.options.root,this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!e?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&e&&t.hash&&(this.fragment=this.getHash().replace(m,""),window.history.replaceState({},document.title,t.protocol+"//"+t.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){a(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),g.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t==this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(t){var e=this.fragment=this.getFragment(t);return s.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(t,e){if(!g.started)return!1;e&&!0!==e||(e={trigger:e});var n=(t||"").replace(m,"");this.fragment!=n&&(this._hasPushState?(0!=n.indexOf(this.options.root)&&(n=this.options.root+n),this.fragment=n,window.history[e.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,e.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,e.replace))):window.location.assign(this.options.root+t),e.trigger&&this.loadUrl(t))},_updateHash:function(t,e,n){n?t.replace((t+"").replace(/(javascript:|#).*$/,"")+"#"+e):t.hash=e
}});var y=t.View=function(t){this.cid=s.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,_="model,collection,el,id,attributes,className,tagName".split(",");s.extend(y.prototype,u,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(t,e,n){return t=document.createElement(t),e&&a(t).attr(e),n&&a(t).html(n),t},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof a?t:a(t),this.el=this.$el[0],!1!==e&&this.delegateEvents(),this},delegateEvents:function(t){if(t||(t=E(this,"events"))){this.undelegateEvents();for(var e in t){var n=t[e];if(s.isFunction(n)||(n=this[t[e]]),!n)throw Error('Method "'+t[e]+'" does not exist');var i=e.match(b),r=i[1],i=i[2],n=s.bind(n,this),r=r+(".delegateEvents"+this.cid);""===i?this.$el.bind(r,n):this.$el.delegate(i,r,n)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=s.extend({},this.options,t));for(var e=0,n=_.length;n>e;e++){var i=_[e];t[i]&&(this[i]=t[i])}this.options=t},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var t=E(this,"attributes")||{};this.id&&(t.id=this.id),this.className&&(t["class"]=this.className),this.setElement(this.make(this.tagName,t),!1)}}}),l.extend=c.extend=h.extend=y.extend=function(t,e){var n=k(this,t,e);return n.extend=this.extend,n};var w={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};t.sync=function(e,n,i){var r=w[e];i||(i={});var o={type:r,dataType:"json"};return i.url||(o.url=E(n,"url")||A()),i.data||!n||"create"!=e&&"update"!=e||(o.contentType="application/json",o.data=JSON.stringify(n.toJSON())),t.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),!t.emulateHTTP||"PUT"!==r&&"DELETE"!==r||(t.emulateJSON&&(o.data._method=r),o.type="POST",o.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",r)}),"GET"!==o.type&&!t.emulateJSON&&(o.processData=!1),a.ajax(s.extend(o,i))},t.wrapError=function(t,e,n){return function(i,r){r=i===e?r:i,t?t(e,r,n):e.trigger("error",e,r,n)}};var x=function(){},k=function(t,e,n){var i;return i=e&&e.hasOwnProperty("constructor")?e.constructor:function(){t.apply(this,arguments)},s.extend(i,t),x.prototype=t.prototype,i.prototype=new x,e&&s.extend(i.prototype,e),n&&s.extend(i,n),i.prototype.constructor=i,i.__super__=t.prototype,i},E=function(t,e){return t&&t[e]?s.isFunction(t[e])?t[e]():t[e]:null},A=function(){throw Error('A "url" property or function must be specified')}}.call(this),this.Handlebars={},function(t){t.VERSION="1.0.rc.1",t.helpers={},t.partials={},t.registerHelper=function(t,e,n){n&&(e.not=n),this.helpers[t]=e},t.registerPartial=function(t,e){this.partials[t]=e},t.registerHelper("helperMissing",function(t){if(arguments.length===2)return void 0;throw Error("Could not find property '"+t+"'")});var e=Object.prototype.toString,n="[object Function]";t.registerHelper("blockHelperMissing",function(i,r){var s=r.inverse||function(){},a=r.fn,o=e.call(i);return o===n&&(i=i.call(this)),i===!0?a(this):i===!1||i==null?s(this):o==="[object Array]"?i.length>0?t.helpers.each(i,r):s(this):a(i)}),t.K=function(){},t.createFrame=Object.create||function(e){t.K.prototype=e;var n=new t.K;return t.K.prototype=null,n},t.registerHelper("each",function(e,n){var i,r=n.fn,s=n.inverse,a="";if(n.data&&(i=t.createFrame(n.data)),e&&e.length>0)for(var o=0,u=e.length;u>o;o++)i&&(i.index=o),a+=r(e[o],{data:i});else a=s(this);return a}),t.registerHelper("if",function(i,r){var s=e.call(i);return s===n&&(i=i.call(this)),!i||t.Utils.isEmpty(i)?r.inverse(this):r.fn(this)}),t.registerHelper("unless",function(e,n){var i=n.fn,r=n.inverse;return n.fn=r,n.inverse=i,t.helpers["if"].call(this,e,n)}),t.registerHelper("with",function(t,e){return e.fn(t)}),t.registerHelper("log",function(e){t.log(e)})}(this.Handlebars),Handlebars.Exception=function(){var t=Error.prototype.constructor.apply(this,arguments);for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);this.message=t.message},Handlebars.Exception.prototype=Error(),Handlebars.SafeString=function(t){this.string=t},Handlebars.SafeString.prototype.toString=function(){return this.string+""},function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},e=/[&<>"'`]/g,n=/[&<>"'`]/,i=function(e){return t[e]||"&amp;"};Handlebars.Utils={escapeExpression:function(t){return t instanceof Handlebars.SafeString?t+"":t==null||t===!1?"":n.test(t)?t.replace(e,i):t},isEmpty:function(t){return t===void 0?!0:t===null?!0:t===!1?!0:Object.prototype.toString.call(t)==="[object Array]"&&t.length===0?!0:!1}}}(),Handlebars.VM={template:function(t){var e={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(t,e,n){var i=this.programs[t];return n?Handlebars.VM.program(e,n):i?i:i=this.programs[t]=Handlebars.VM.program(e)},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(n,i){return i=i||{},t.call(e,Handlebars,n,i.helpers,i.partials,i.data)}},programWithDepth:function(t,e){var n=Array.prototype.slice.call(arguments,2);return function(i,r){return r=r||{},t.apply(this,[i,r.data||e].concat(n))}},program:function(t,e){return function(n,i){return i=i||{},t(n,i.data||e)}},noop:function(){return""},invokePartial:function(t,e,n,i,r,s){var a={helpers:i,partials:r,data:s};if(t===void 0)throw new Handlebars.Exception("The partial "+e+" could not be found");if(t instanceof Function)return t(n,a);if(Handlebars.compile)return r[e]=Handlebars.compile(t,{data:s!==void 0}),r[e](n,a);throw new Handlebars.Exception("The partial "+e+" could not be compiled when running in runtime-only mode")}},Handlebars.template=Handlebars.VM.template,function(){var t=Handlebars.template,e=Handlebars.templates=Handlebars.templates||{};e.checkin=t(function(t,e,n){n=n||t.helpers;var i,r="",s="function",a=this.escapeExpression;return r+='<div class="grid_3 gig-outerbox">\n	<div class="gig-widbox">\n		<h3 class="gig-widtitle">\n			<img src="',i=e.user_image,i=typeof i===s?i():i,r+=a(i)+'" alt="" class="img_floatLeft gig-avatar">\n			',i=e.name,i=typeof i===s?i():i,r+=a(i)+'\n		</h3>\n		<p class="gig-checkedin">just checked in</p>\n	</div>\n</div>	\n'}),e.image=t(function(t,e,n){n=n||t.helpers;var i,r,s,a,o="",u="function",l=this.escapeExpression,c=n.helperMissing;return o+='<div class="gig-widbox gig-widimgbox">\n	<a href="',i=e.large_photo,i=typeof i===u?i():i,o+=l(i)+'" class="modal"><img src="',i=e.thumb_photo,i=typeof i===u?i():i,o+=l(i)+'" alt=""></a>\n	<div class="gig-imgauthor">\n		<h3 class="gig-widtitle">\n			<img src="images/',i=e.service,i=typeof i===u?i():i,o+=l(i)+'.png" alt="',i=e.service,i=typeof i===u?i():i,o+=l(i)+'" class="img_floatLeft gig-avatar">\n			<a href="',i=e.user_id,r=e.username,s=e.service,a=n.profilelink,i=a?a.call(e,s,r,i,{hash:{}}):c.call(e,"profilelink",s,r,i,{hash:{}}),(i||i===0)&&(o+=i),o+='" target="_top"><img src="',i=e.user_image,i=typeof i===u?i():i,o+=l(i)+'" alt="avatar" class="img_floatLeft gig-avatar"></a>\n			',i=e.name,i=typeof i===u?i():i,o+=l(i)+"\n		</h3>\n	</div>\n</div>\n"}),e.text=t(function(t,e,n){n=n||t.helpers;var i,r,s,a,o="",u=n.helperMissing,l="function",c=this.escapeExpression;return o+='<div class="gig-widbox">\n	<p>',i=e.text,a=n.linkify,i=a?a.call(e,i,{hash:{}}):u.call(e,"linkify",i,{hash:{}}),(i||i===0)&&(o+=i),o+='</p>\n	<h3 class="gig-widtitle">\n		<img src="images/',i=e.service,i=typeof i===l?i():i,o+=c(i)+'.png" alt="',i=e.service,i=typeof i===l?i():i,o+=c(i)+'" class="img_floatLeft gig-avatar">\n		<a href="',i=e.user_id,r=e.username,s=e.service,a=n.profilelink,i=a?a.call(e,s,r,i,{hash:{}}):u.call(e,"profilelink",s,r,i,{hash:{}}),(i||i===0)&&(o+=i),o+='" target="_top"><img src="',i=e.user_image,i=typeof i===l?i():i,o+=c(i)+'" alt="avatar" class="img_floatLeft gig-avatar"></a>\n		',i=e.name,i=typeof i===l?i():i,o+=c(i)+'\n	</h3>\n	<div class="gig-actionbtns">\n		<a href="https://twitter.com/intent/tweet?screen_name=',i=e.username,i=typeof i===l?i():i,o+=c(i)+'" data-related="',i=e.username,i=typeof i===l?i():i,o+=c(i)+',gignal">@reply</a>\n	</div>\n</div>\n'})}();var app={collections:{},models:{},views:{},templates:Handlebars.templates};app.models.Event=Backbone.Model.extend({urlRoot:"http://api.gignal.com/event/api/eventId/",idAttribute:"event_id"}),app.models.Text=Backbone.Model.extend({idAttribute:"text_stream_id"}),app.models.Photo=Backbone.Model.extend({idAttribute:"photo_stream_id"}),app.collections.Stream=Backbone.Collection.extend({calling:!1,parameters:{cid:0,limit:20,sinceIdText:0,sinceIdPhoto:0},initialize:function(){this.update(),this.setIntervalUpdate()},url:function(){return app.event.urlRoot+app.event.get("id")},comparator:function(t){return t.get("created_on")},parse:function(t){var e=this;app.event.set(t.event);var n=[],i=[];if(_.each(t.text,function(t){var r=e.get(t.text_stream_id);if(r===void 0){r=new app.models.Text(t);var s=new app.views.Text({model:r});n.push(r),i.push(s),r.id>e.parameters.sinceIdText&&(e.parameters.sinceIdText=r.id)}}),_.each(t.photos,function(t){var r=e.get(t.photo_stream_id);if(r===void 0){r=new app.models.Photo(t);var s=new app.views.Photo({model:r});n.push(r),i.push(s),r.id>e.parameters.sinceIdPhoto&&(e.parameters.sinceIdPhoto=r.id)}}),i.length===0)return[];var r=_.sortBy(i,function(t){return e.comparator(t.model)});return _.each(r,function(t){app.view.$el.prepend(t.render().$el).masonry("reload")}),app.view.refresh(),this.parameters.cid=0,n},update:function(){var t=this;this.calling||(this.calling=!0,this.fetch({add:!0,cache:!0,timeout:1e4,data:{limit:this.parameters.limit,sinceIdPhoto:this.parameters.sinceIdPhoto,sinceIdText:this.parameters.sinceIdText,cid:this.parameters.cid++},success:function(){t.calling=!1},error:function(){t.calling=!1}}))},setIntervalUpdate:function(){this.intervalID=window.setInterval(function(){app.stream.update()},4500)}}),app.views.Event=Backbone.View.extend({el:"#gignal",initialize:function(){this.$el.masonry({itemSelector:".gig-outerbox",isAnimated:!0,animationOptions:{duration:750,easing:"linear",queue:!1}})},refresh:function(){var t=this;this.$el.imagesLoaded(function(){t.$el.masonry()})}}),app.views.Text=Backbone.View.extend({className:"gig-outerbox",render:function(){return this.$el.html(app.templates.text(this.model.toJSON())),this}}),app.views.Photo=Backbone.View.extend({className:"gig-outerbox",render:function(){return this.$el.html(app.templates.image(this.model.toJSON())),this}}),app.Router=Backbone.Router.extend({routes:{"event/:id":"event"},event:function(t){app.event=new app.models.Event({id:t}),app.stream=new app.collections.Stream}}),function(t){t(function(){"use strict";Handlebars.registerHelper("profilelink",function(t,e,n){var i="http://"+t+".com/";return i+=e?e:n}),Handlebars.registerHelper("linkify",function(t){if(t!=null){var e=/(\b(https?):\/\/[\-A-Z0-9+&@#\/%?=~_|!:,.;]*[\-A-Z0-9+&@#\/%=~_|])/gi;return t.replace(e,'<a href="$1" target="_top" class="nodelink">link</a>')}}),app.view=new app.views.Event,new app.Router,Backbone.history.start()})}(jQuery);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-183817-27"]),_gaq.push(["_trackPageview"]),function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()